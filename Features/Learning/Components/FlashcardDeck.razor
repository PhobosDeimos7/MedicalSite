@using MedicalSite.Features.Learning.Models

<div class="flex flex-col items-center justify-center space-y-8 py-8 w-full">
    @if(Cards != null && Cards.Any())
    {
        <!-- Progress -->
        <div class="text-sm font-bold text-gray-500 uppercase tracking-wider">
            Card @(CurrentIndex + 1) of @Cards.Count
        </div>

        <!-- 3D Card Container -->
        <div class="group relative h-64 w-full max-w-lg cursor-pointer perspective" @onclick="FlipCard">
            <div class="relative h-full w-full shadow-xl transition-all duration-500 preserve-3d @(IsFlipped ? "rotate-y-180" : "")">
                <!-- Inside the Front Face div -->
<div class="absolute top-4 right-4 flex gap-1">
    @foreach(var tag in Cards[CurrentIndex].Tags)
    {
        <span class="text-[10px] bg-slate-100 text-slate-500 px-2 py-1 rounded-full uppercase tracking-wider">
            @tag
        </span>
    }
</div>
                <!-- Front (Question) -->
                <div class="absolute inset-0 flex items-center justify-center rounded-2xl bg-white p-8 border-2 border-[var(--app-border)] backface-hidden">
                    <p class="text-2xl font-bold text-[var(--app-text)] text-center">@Cards[CurrentIndex].Front</p>
                    <span class="absolute bottom-4 text-xs text-gray-400 uppercase">Tap to flip</span>
                </div>

                <!-- Back (Answer) -->
                <div class="absolute inset-0 flex items-center justify-center rounded-2xl bg-blue-600 p-8 border-2 border-blue-600 backface-hidden rotate-y-180">
                    <p class="text-xl font-medium text-white text-center">@Cards[CurrentIndex].Back</p>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex gap-4">
            <button class="px-6 py-2 rounded-full border border-gray-300 hover:bg-gray-100 disabled:opacity-50" 
                    @onclick="Prev" disabled="@(CurrentIndex == 0)">Prev</button>
            <button class="px-6 py-2 rounded-full bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50" 
                    @onclick="Next" disabled="@(CurrentIndex == Cards.Count - 1)">Next</button>
        </div>
    }
    else
    {
        <p class="text-gray-500">No flashcards available.</p>
    }
</div>

<style>
    .perspective { perspective: 1000px; }
    .preserve-3d { transform-style: preserve-3d; }
    .backface-hidden { backface-visibility: hidden; }
    .rotate-y-180 { transform: rotateY(180deg); }
</style>

@code {
    [Parameter] public List<Flashcard> Cards { get; set; } = new();
    private int CurrentIndex = 0;
    private bool IsFlipped = false;

    private void FlipCard() => IsFlipped = !IsFlipped;
    private void Next() { if (CurrentIndex < Cards.Count - 1) { IsFlipped = false; CurrentIndex++; } }
    private void Prev() { if (CurrentIndex > 0) { IsFlipped = false; CurrentIndex--; } }
}