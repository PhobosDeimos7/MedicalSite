@page "/learning-centre"
@using MedicalSite.Features.Learning.Models
@using MedicalSite.Features.Learning.Services
@inject LearningService LearningService
@inject NavigationManager Nav

<PageTitle>Learning Centre</PageTitle>

<div class="max-w-4xl mx-auto space-y-8">
    <div class="text-center">
        <h1 class="text-3xl font-bold text-[var(--app-text)]">Learning Centre</h1>
        <p class="text-slate-500 mt-2">Choose a subject to explore topics.</p>
    </div>

    @if (Subjects == null)
    {
        <div class="text-center py-10">Loading content...</div>
    }
    else
    {
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            @foreach (var subject in Subjects)
            {
                <div class="bg-[var(--app-surface)] border border-[var(--app-border)] rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow">
                    <h2 class="text-xl font-bold text-[var(--app-text)] mb-2">@subject.Name</h2>
                    <p class="text-sm text-slate-500 mb-4">@subject.Description</p>
                    
                    @if(subject.Topics.Any())
                    {
                        <div class="space-y-2">
                            @foreach(var topic in subject.Topics)
                            {
                                <button @onclick='() => Nav.NavigateTo($"/learning/{subject.Id}/{topic.Id}")'
                                        class="block w-full text-left px-3 py-2 rounded bg-slate-50 hover:bg-blue-50 text-slate-700 hover:text-blue-700 text-sm transition-colors">
                                    ðŸ“„ @topic.Title
                                </button>
                            }
                        </div>
                    }
                    else
                    {
                        <span class="text-xs text-slate-400 italic">No topics added yet.</span>
                    }
                </div>
            }
        </div>
    }
</div>

@code {
    private List<Subject>? Subjects;
    protected override async Task OnInitializedAsync()
    {
        Subjects = await LearningService.GetSubjectsAsync();
    }
}